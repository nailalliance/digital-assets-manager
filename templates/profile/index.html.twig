{% extends 'base.html.twig' %}

{% block title %}My Profile | {{ parent() }}{% endblock %}

{# {% form_theme form 'tailwind_form_theme.html.twig' %}#}

{% block body %}
    <h1 class="text-3xl font-bold mb-8">My Profile</h1>

    <div class="bg-white rounded-lg shadow p-6">
        <h2 class="text-xl font-semibold mb-4">API Access Tokens</h2>
        <p class="text-gray-600 mb-4">Generate personal access tokens to use with external applications like the Adobe Creative Cloud plugin.</p>

        {% for flash_message in app.flashes('success') %}
            <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
                <span class="block sm:inline">{{ flash_message }}</span>
            </div>
        {% endfor %}

        {% for new_token in app.flashes('new_api_token') %}
            <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative mb-4 font-mono">
                {{ new_token }}
            </div>
        {% endfor %}

        {# {{ form_start(form) }}#}
        {#     {{ form_widget(form) }}#}
        {#     <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-violet-600 hover:bg-violet-700">#}
        {#          {{ button_label | default('Generate Token ') }}#}
        {#     </button>#}
        {# {{ form_end(form) }}#}

        <div class="flex flex-col gap-2">
            {% for apiToken in apiTokens %}
                 <form action="{{ path('app_profile_api_token_create', {tokenFor: apiToken}) }}" method="post">
                      <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-violet-600 hover:bg-violet-700">
                          Generate {{ apiToken | capitalize }} Token
                      </button>
                 </form>
            {% endfor %}
        </div>


        <h3 class="text-lg font-semibold mt-8 mb-2">Your Tokens</h3>
        <ul class="divide-y divide-gray-200">
            {% for token in app.user.apiTokens %}
                <li class="py-3 flex justify-between items-center">
                    <span class="text-gray-700">Token created on {{ token.createdAt|date('M d, Y') }}</span>
                    {# Add delete functionality here in a future step #}
                </li>
            {% else %}
                <li class="py-3 text-gray-500">You have not generated any API tokens yet.</li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}
