{% form_theme form 'tailwind_form_theme.html.twig' %}

{# 1. Connect the form to the new Stimulus controller and add a turbo-frame attribute #}
{{ form_start(form, {'attr': {
    'data-controller': 'form-submit',
    'data-turbo-frame': 'assets-field-frame'
}}) }}
<div class="space-y-4">
    {{ form_row(form.title) }}
    {{ form_row(form.portal) }}

    {# 2. This field now triggers the form to submit on change #}
    {{ form_row(form.brand, {
        'attr': {
            'data-action': 'change->form-submit#submit'
        }
    }) }}

    {{ form_row(form.post_at) }}
    {{ form_row(form.description) }}
    {{ form_row(form.content) }}

</div>
{# Include the asset selector component #}
{{ include('admin/social_media_posts/_asset_selector.html.twig', { form: form }) }}

<div class="mt-8 pt-5 border-t border-gray-200 flex justify-end space-x-3">
    <a href="{{ path('admin_social_calendar_index') }}" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">
        Back to Calendar
    </a>
    <button class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-violet-600 hover:bg-violet-700">
        {{ button_label|default('Create Post') }}
    </button>
</div>
{{ form_end(form) }}
